---
title: 统一社会信用代码的校验码验证
url: The_validation_of_the_unified_social_credit_identifier
date: 2017-11-05 10:52:03
tags:
  - 金融
categories:
  - 金融
---

# 前言
前段时间要做[毕业设计](https://github.com/Ahaochan/invoice), 需要了解发票的相关知识。
而购销单位必须要有统一社会信用代码。
在[中国企业登记网](http://qyj.saic.gov.cn/zyfb/gszjfb/201612/t20161208_232473.html)上有详细的介绍。

<!-- more -->

# 介绍
统一社会信用代码由18位`数字`或`大写字母`组成。
详细的介绍在[中国企业登记网](http://qyj.saic.gov.cn/zyfb/gszjfb/201612/t20161208_232473.html)中。

<table style="text-align: center;"
  ><tr
    ><th>代码序号</th><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td
  ></tr
  ><tr
    ><th>代码</th><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td
  ></tr
  ><tr><th>说明</th
    ><td>登记管理部门代码1位</td
    ><td>机构类别代码1位</td
    ><td colspan="6">登记关机机关行政区划码6位</td
    ><td colspan="9">主题标识码(组织机构代码9位)</td
    ><td>校验码1位</td
  ></tr></table>
  
# 校验码计算
下面是js的计算代码。
```js
function (value){
    // value = 91350100M000100Y43;
    // value = 12440200455904030C;
    
    // 判断字符串长度是否为18
    if (!$.isString(value) || value.length !== 18) {
        return false;
    }
    // 转化为大写字母
    value = value.toUpperCase();

    var valid = false;
    var array = [];
    
    var dist = {
        // 基础值
        '0': 0, '1': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9,
        'A': 10, 'B': 11, 'C': 12, 'D': 13, 'E': 14, 'F': 15, 'G': 16, 'H': 17, 'J': 18,
        'K': 19, 'L': 20, 'M': 21, 'N': 22, 'P': 23, 'Q': 24, 'R': 25, 'T': 26, 'U': 27,
        'W': 28, 'X': 29, 'Y': 30,
        // 权值对应字母
        '10': 'A', '11': 'B', '12': 'C', '13': 'D', '14': 'E', '15': 'F',
        '16': 'G', '17': 'H', '18': 'J', '19': 'K', '20': 'L', '21': 'M',
        '22': 'N', '23': 'P', '24': 'Q', '25': 'R', '26': 'T', '27': 'U',
        '28': 'W', '29': 'X', '30': 'Y'
    };
    
    // 17位权值
    var power = [1, 3, 9, 27, 19, 26, 16, 17, 20, 29, 25, 13, 8, 24, 10, 30, 28];

    // 1. 获取前17位的基础值
    for (var i = 0, len = value.length - 1; i < len; i++) {
        var num = dist[value[i]];
        if (num === undefined) {
            return false;
        }
        array.push(num);
    }
    
    // 2. 获取前17位的权值的和
    var sum = 0;
    for (var i = 0, len = array.length; i < len; i++) {
        sum += array[i] * power[i];
    }
    
    // 3. 将(31-权值和)%31的值转化为字母, 和第18位进行比较
    if (dist[31 - sum % 31] + '' === value.charAt(value.length - 1)) {
        valid = true;
    }
    return valid;
}
```

