---
title: 单例模式的最佳实践
url: The_Best_practice_for_Singleton_Pattern
tags:
  - 设计模式
  - 最佳实践
categories:
  - 编程杂谈
date: 2017-09-24 13:05:29
---
# 前言
单例模式算是设计模式入门的最简单的一个模式, 由于 Java 语言的特性(指令重排序), 导致同时也是最难的一个模式。

所幸, 先驱者Joshua Bloch在Google I/O 2008上的新书Effective Java介绍了单例模式的最佳实践。这本神书我还没来的及看, 但在国外好像备受推崇, 所以有机会还是看看。
<!-- more -->

# Java 5 之后的最佳实践
` enum ` 作为枚举关键字, 很难想像到它和 ` 单例模式 ` 联系到一起。
但是换种思路, 枚举类只有一个元素, 不就是单例模式了吗?
枚举类还可以添加自定义的方法。完全可以当成一个类来使用。
```java
public enum Foo {
    INSTANCE;
    public static Foo getInstance() {   return INSTANCE;   }
    public void hello(String msg)   {   System.out.println("hello "+msg); }
    public static void main(String[] args) { Foo.getInstance().hello("world"); }
}
```
# 在Java 5 之前的最佳实践
争议太多了, 本来写了一堆。
双重锁, 饿汉模式, 懒汉模式, 防止反射攻击等等。
想想还是算了, 现在也没多少人在用Java5之前的代码了吧。
而且stackoverflow上也有不少反对的声音。具体也可以去看看。

发现我以前还写了一篇{% post_link posts/编程杂谈-单例模式 %}, 当然现在看来, 是有些漏洞的。

# 参考资料
- [What is an efficient way to implement a singleton pattern in Java?](https://stackoverflow.com/questions/70689)
